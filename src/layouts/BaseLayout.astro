---
import { site } from '../data/site';

const {
  title = site.metaTitle,
  description = site.description,
  canonical,
  image = site.ogImage,
  noindex = false,
  pageType = 'website'
} = Astro.props;

const canonicalUrl = new URL(canonical ?? Astro.url.pathname, site.url).toString();
const ogImageUrl = image.startsWith('http') ? image : new URL(image, site.url).toString();
const robots = noindex ? 'noindex, nofollow' : 'index, follow';
const structuredData = {
  '@context': 'https://schema.org',
  '@type': 'Person',
  name: site.author,
  url: site.url,
  jobTitle: site.role,
  image: ogImageUrl,
  sameAs: site.socials.filter(Boolean),
  worksFor: {
    '@type': 'Organization',
    name: site.name
  }
};
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="author" content={site.author} />
    <meta name="keywords" content={site.keywords} />
    <meta name="robots" content={robots} />
    <link rel="canonical" href={canonicalUrl} />

    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content={pageType} />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:site_name" content={site.name} />
    <meta property="og:image" content={ogImageUrl} />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImageUrl} />

    <meta name="theme-color" content={site.themeColor} />

    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="icon" href="/icon.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/manifest.webmanifest" />

    <link rel="preload" href="/assets/css/plugins.css" as="style" />
    <link rel="preload" href="/assets/css/style.css" as="style" />
    <link rel="stylesheet" href="/assets/css/plugins.css" />
    <link rel="stylesheet" href="/assets/css/style.css" />
    <link rel="stylesheet" href="/assets/css/custom.css" />

    <script type="application/ld+json">{JSON.stringify(structuredData)}</script>
  </head>
  <body id="top">
    <slot />
    <script is:inline src="/assets/js/portfolio-animations.js"></script>
  </body>
</html>
